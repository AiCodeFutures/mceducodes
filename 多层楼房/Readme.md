# 多层楼房脚本说明 (基础版)

本目录脚本 `main.py` 提供一个参数化多层楼房自动生成示例，通过聊天命令 `build` 在玩家脚下位置快速构建：地基 → 多层楼体 → 窗带 → 大门 → 斜坡屋顶 → 顶层灯光。

## 1. 快速使用

1. 在 Minecraft Education 中打开 Code Builder (C)。
2. 新建 / 粘贴此目录下 `main.py` 内容。
3. 回到游戏输入：`build`
4. 等待生成完成（批量填充需数秒）。

## 2. 主要参数

| 变量            | 作用       | 默认 | 说明               |
| --------------- | ---------- | ---- | ------------------ |
| `W`             | 建筑宽 (x) | 20   | 外墙含在 0..W-1 内 |
| `D`             | 建筑深 (z) | 20   | 外墙含在 0..D-1 内 |
| `FLOORS`        | 楼层数     | 3    | 可调增减层         |
| `FLOOR_H`       | 单层总高度 | 7    | 含地板到该层顶墙   |
| `ROOF_OVERHANG` | 屋檐外挑   | 3    | 影响屋顶基底尺寸   |

调整参数后重新执行 `build` 即可生成新尺寸（旧建筑不会自动清除）。

## 3. 生成流程概览

1. `build_foundation`：外扩 3 格、2 层石砖地基。
2. 楼层循环：按 `level * FLOOR_H` 计算每层基准高度。
3. 地板：金合欢木板，四周缩 1 格避免与墙同层冲突。
4. 外墙：四面石砖一次性填充（自 y0 起覆盖边缘）。
5. 内腔：再用 `AIR` 挖空内部形成空间。
6. 窗带：从第二层开始，在高度区间 `y0+2..y0+3` 用玻璃替换墙带。
7. 灯光：在除首层外的“上一层天花板”嵌入海晶灯（步长 5、内缩 2）。
8. 一层正门：前墙中点开 2 格高门洞并放置木门。
9. 斜屋顶：3 层递减包围盒（外挑 → 收缩）。
10. 顶层灯：屋顶底面再嵌入一层灯阵。

## 4. 关键函数

| 函数                         | 职责              | 备注          |
| ---------------------------- | ----------------- | ------------- |
| `p(base, dx, dy, dz)`        | 相对坐标快捷生成  | 降低重复代码  |
| `build_foundation`           | 地基外扩与填充    | 与主体剥离    |
| `embed_lights_on_plane`      | 在指定 Y 平面嵌灯 | 先 AIR 再放灯 |
| `build_sloped_roof_3_layers` | 三层斜屋顶        | 可改层数      |
| `build_building`             | 主 orchestrator   | 调用各子模块  |

## 5. 设计要点

- “先填满后挖空”简化墙体连贯性。
- 统一用 `y0 = level * FLOOR_H` 推导相关高度，便于重构。
- 窗/灯条件用 `level > 0` 区分首层和上层。
- 屋顶采用递减包围盒，算法可扩展为任意层数或材质渐变。

## 6. 常见自定义示例

| 目标         | 修改建议                                  |
| ------------ | ----------------------------------------- |
| 增加层数     | 调高 `FLOORS`，注意世界高度限制           |
| 改窗高度     | 调整 `y0+2, y0+3` 区间                    |
| 改灯密度     | 改 `range(2, W-2, 5)` 的步长 5 为更小值   |
| 换材质       | 全局替换 `STONE_BRICKS` / `PLANKS_ACACIA` |
| 扩展屋顶层数 | 将屋顶循环 `for _ in range(3)` 改变量     |
| 添加内部结构 | 在挖空后追加楼梯 / 装饰放置逻辑           |

## 7. FAQ

| 问题         | 解决                               |
| ------------ | ---------------------------------- |
| 命令没反应   | 确认保存并输入 `build`（无需 `/`） |
| 建筑穿进山体 | 换平坦区域或先清理方块             |
| 想重建       | 换位置或手动清除旧建筑再执行       |
| 光照不均匀   | 减少灯步长，例如改为 4 或 3        |

## 8. 扩展方向

- 参数通过聊天动态输入：解析玩家附加文本。
- 加内部分隔（房间、走廊）。
- 屋顶样式多态（平顶、穹顶、斜坡层数变量）。
- 插件化窗策略：不同楼层/朝向用不同窗形。

## 9. 教学要点提示

1. 坐标系与相对位移函数封装的重要性。
2. 分阶段生成（地基 → 楼层 → 屋顶）利于调试。
3. 使用批量填充 API 提升性能与代码简洁。
4. 条件逻辑（`level > 0`）做差异化层级设计。
5. 参数集中化使得“调参即重构”成为可能。

---

如需带水电梯版本，请查看上级目录 `带水电梯的多层楼房/`。
